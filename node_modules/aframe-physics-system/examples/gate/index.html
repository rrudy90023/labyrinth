<html>
  <head>
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta http-equiv="content-type" content="text/html; charset=utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1,shrink-to-fit=no,user-scalable=no,maximum-scale=1">
    <title>Examples â€¢ Gate</title>
    <script src="https://aframe.io/releases/0.5.0/aframe.min.js"></script>
    <script src="https://rawgit.com/takahirox/aframe-rain/master/build/aframe-rain.min.js"></script>
    <script src="../bundle.js"></script>
    <script>
/**
 * Force Pushable component.
 *
 * Applies behavior to the current entity such that cursor clicks will apply a
 * strong impulse, pushing the entity away from the viewer.
 *
 * Requires: physics
 */
AFRAME.registerComponent('force-pushable', {
  schema: {
    force: { default: 100 }
  },
  init: function () {
    this.pStart = new THREE.Vector3();
    this.sourceEl = this.el.sceneEl.querySelector('[camera]');
    this.el.addEventListener('click', this.forcePush.bind(this));
  },
  forcePush: function () {
    var force,
        el = this.el,
        pStart = this.pStart.copy(this.sourceEl.getAttribute('position'));

    // Compute direction of force, normalize, then scale.
    force = el.body.position.vsub(pStart);
    force.normalize();
    force.negate(force);
    force.scale(this.data.force, force);

    el.body.applyImpulse(force, el.body.position);
  }
});
</script>
  </head>
  <body>
    <a-scene rain fog="color: #CCDDEE; far: 35;">
      <!-- Player -->
      <a-entity camera="userHeight: 1.6" look-controls wasd-controls position="0 6 0">
        <a-entity cursor
                  raycaster="far: 75"
                  position="0 0 -1"
                  geometry="primitive: circle; radius: 0.01; segments: 4;"
                  material="color: #FF4444; shader: flat"></a-entity>
      </a-entity>

      <a-entity obj-model="obj: ./assets/gate_scene.obj;
                           mtl: ./assets/gate_scene.mtl;">
      </a-entity>
      <a-entity obj-model="obj: ./assets/gate_gate.obj;
                           mtl: ./assets/gate_gate.mtl;"
                position="0 5 -2"
                dynamic-body="shape: box"
                force-pushable="force: 10"
                constraint="type: hinge;
                            target: #post;
                            axis: 0 1 0;
                            targetAxis: 0 1 0;
                            pivot: 0 1.5 -0.25;
                            targetPivot: 0 0 0;">
      </a-entity>
      <a-box id="post"
             static-body
             visible="false"
             height="3"
             position="0 6.5 -2.25"></a-box>
      <a-box id="stopper"
             static-body
             visible="false"
             depth="6"
             height="3"
             position="0 6.5 -5"></a-box>

      <a-sphere radius="4000" material="color: #CCDDEE; side: back;"></a-sphere>

      <!-- Lighting -->
      <a-light type="ambient" color="#bbb"></a-light>
      <a-light color="#ccc" position="0 30 0" distance="100" intensity="0.4" type="point"></a-light>
      <a-light color="#ccc" position="3 10 -10" distance="50" intensity="0.4" type="point"></a-light>
    </a-scene>
  </body>
</html>
